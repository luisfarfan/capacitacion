{% extends "base/base.html" %}
{% load staticfiles %}
{% block title %}
    Modulo de Registro de Local y Aulas
{% endblock %}

{% block css %}
    <style>

        table {
            font-size: 11px !important;
        }

        fieldset {
            border: 1px groove #ddd !important;
            padding: 0 1.4em 1.4em 1.4em !important;
            margin: 0 0 1.5em 0 !important;
            -webkit-box-shadow: 0px 0px 0px 0px #000;
            box-shadow: 0px 0px 0px 0px #000;
        }

        legend {
            font-size: 1.2em !important;
            font-weight: bold !important;
            text-align: left !important;
            width: inherit;
            /* Or auto */
            padding: 0 10px;
            /* To give a bit of padding on the left and right */
            border-bottom: none;
        }
    </style>
{% endblock %}


{% block content %}
    <div class="row">
        <div class="col-md-offset-8 col-md-4">
            <div class="panel panel-flat">
                <div class="table-responsive">
                    <table class="table table-bordered">
                        <thead>
                        <tr class="bg-blue">
                            <th>PEA A CAPACITAR</th>
                            <th>PEA RECLUTADA</th>
                            <th>TOTAL DE AULAS</th>
                            <th>AULAS OBTENIDAS</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td><input type="text" class="form-control" id="cant_meta"></td>
                            <td><input type="text" class="form-control" id="cant_reclutada"></td>
                            <td><input type="text" class="form-control" id="aulas_meta_cantidad" value="10"></td>
                            <td><input type="text" class="form-control" id="capacidad_ambiente"></td>

                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

    </div>
    <div class="panel panel-primary panel-bordered">
        <div class="panel-heading">
            <h5 class="panel-title">UBICACIÓN GEOGRÁFICA</h5>
            <div class="heading-elements">
                <ul class="icons-list">
                    <li>
                        <a data-action="collapse"></a>
                    </li>
                    <li>
                        <a data-action="close"></a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="panel-body">
            <div class="row">
                <div class="text-right">
                    <button type="button" class="btn btn-primary btn-sm" data-toggle="modal"
                            data-target="#modal_localesbyubigeo" id="buscarlocal" class="btn btn-primary">
                        Buscar Local Seleccionado <i
                            class="icon-arrow-right14 position-right"></i></button>
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-md-3">
                    <div class="form-group">
                        <label class="text-bold">Departamento</label>
                        <select id="departamentos" class="select">
                            <option value="">Seleccione</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label class="text-bold">Provincia</label>
                        <select id="provincias" class="select">
                            <option value="">Seleccione</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label class="text-bold">Distrito</label>
                        <select id="distritos" class="select">
                            <option value="">Seleccione</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label class="text-bold">Zona</label>
                        <select id="zona" class="select">
                            <option value="0">Seleccione</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="panel panel-primary panel-bordered">
        <div class="panel-heading">
            <h5 class="panel-title">REGISTRO DE LOCAL</h5>
            <div class="heading-elements">
                <ul class="icons-list">
                    <li>
                        <a data-action="collapse"></a>
                    </li>
                    <li>
                        <a data-action="close"></a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="panel-body">
            <form class="form-validate-jquery" id="form_local" action="#">
                <input type="hidden" id="id_local">
                <div id="localdata">
                    <fieldset class="content-group">
                        <legend class="text-bold">Etapa y Curso</legend>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label>Etapa</label>
                                    <select id="etapa" class="form-control" onchange="getCursos(this.value)">
                                        <option value="-1">Seleccione..</option>
                                        <option value="1">CENSO EXPERIMENTAL</option>
                                        <option value="2">Empadronamiento</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label>Cursos</label>
                                    <select id="cursos" name="id_curso" class="select2 form-control">
                                        <option value="">Seleccione</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <button type="button" class="btn btn-primary btn-sm" data-toggle="modal"
                                        data-target="#modal_localesmarco" id="buscarlocalmarco" class="btn btn-primary">
                                    Buscar Local Marco <i
                                        class="icon-arrow-right14 position-right"></i></button>
                            </div>
                        </div>
                    </fieldset>
                    <fieldset class="content-group">
                        <legend class="text-bold">NOMBRE Y DIRECCIÓN</legend>
                        <div class="row">
                            <div class="col-md-9">
                                <div class="form-group">
                                    <label>Nombre de Local</label>
                                    <input type="text" required="required" name="nombre_local"
                                           class="form-control" placeholder="">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label>Zona N° Ubicación del local</label>
                                    <select name="zona_ubicacion_local" class="form-control" id="zona_ubicacion_local">
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label>Tipo de Vía</label>
                                    <select name="tipo_via" class="select" id="tipo_via">
                                        <option value="">Seleccione</option>
                                        <option value="1">AVENIDA</option>
                                        <option value="2">CALLE</option>
                                        <option value="3">JIRÓN</option>
                                        <option value="4">PASAJE</option>
                                        <option value="5">CARRETERA</option>
                                        <option value="6">OTRO</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label>Nombre de Vía</label>
                                    <input type="text" required="required" name="nombre_via"
                                           class="form-control" placeholder="">
                                </div>
                            </div>
                            <div class="col-md-1">
                                <div class="form-group">
                                    <label>N°Puerta</label>
                                    <input type="text" required="required" name="n_direccion"
                                           class="form-control" placeholder="">
                                </div>
                            </div>
                            <div class="col-md-1">
                                <div class="form-group">
                                    <label>Piso</label>
                                    <input type="text" required="required" name="piso_direccion"
                                           class="form-control" placeholder="">
                                </div>
                            </div>
                            <div class="col-md-1">
                                <div class="form-group">
                                    <label>MZ</label>
                                    <input type="text" name="mz_direccion"
                                           class="form-control" placeholder="">
                                </div>
                            </div>
                            <div class="col-md-1">
                                <div class="form-group">
                                    <label>Lote</label>
                                    <input type="text" name="lote_direccion"
                                           class="form-control" placeholder="">
                                </div>
                            </div>
                            <div class="col-md-1">
                                <div class="form-group">
                                    <label>KM</label>
                                    <input type="text" name="km_direccion"
                                           class="form-control" placeholder="">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label>Referencia</label>
                                    <input type="text" name="referencia"
                                           class="form-control" placeholder="">
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Teléfono Fijo</label>
                                    <input type="text" name="telefono_local_fijo"
                                           class="form-control" placeholder="">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Teléfono Celular</label>
                                    <input type="text" name="telefono_local_celular"
                                           class="form-control" placeholder="">
                                </div>
                            </div>
                        </div>
                    </fieldset>
                    <fieldset class="content-group">
                        <legend class="text-bold">PERIODO DE CAPACITACIÓN Y TURNO</legend>
                        <div class="row">
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label>Fecha Inicio</label>
                                    <input type="text" required="required" name="fecha_inicio"
                                           class="daterange-single form-control" placeholder="">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label>Fecha Fin</label>
                                    <input type="text" required="required" name="fecha_fin"
                                           class="daterange-single form-control" placeholder="">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label>Turno de Uso Local</label>
                                    <select name="turno_uso_local" class="select">
                                        <option value="0">MAÑANA</option>
                                        <option value="1">TARDE</option>
                                        <option value="2">TODO EL DIA</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </fieldset>
                    <input type="text" style="display: none" name="x" id="x">
                    <input type="text" style="display: none" name="y" id="y">

                    <fieldset class="content-group">
                        <legend class="text-bold">Datos de Funcionario del INEI</legend>
                        <div class="row">
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label>Apellidos y Nombres</label>
                                    <select class="form_control select" name="funcionario_nombre"
                                            id="funcionario_nombre">
                                        <option value="-1">Seleccione</option>
                                        {% for funcionario in funcionarios %}
                                            <option value="{{ funcionario.id_per }}">
                                                {{ funcionario.dni }} - {{ funcionario.ape_paterno }}
                                                {{ funcionario.ape_materno }} {{ funcionario.nombre }} </option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label>Cargo</label>
                                    <input type="text" name="funcionario_cargo" disabled
                                           class="form-control" placeholder="">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label>Email</label>
                                    <input type="text" required="required" name="funcionario_email" disabled
                                           class="form-control" placeholder="">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label>Teléfono Celular</label>
                                    <input type="text" name="funcionario_celular" disabled
                                           class="form-control" placeholder="">
                                </div>
                            </div>
                        </div>
                    </fieldset>
                    <fieldset class="content-group">
                        <legend class="text-bold">Datos del Responsable del Local</legend>
                        <div class="row">
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label>Apellidos y Nombres</label>
                                    <input type="text" required="required" name="responsable_nombre"
                                           class="form-control" placeholder="">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label>Email</label>
                                    <input type="text" required="required" name="responsable_email"
                                           class="form-control" placeholder="">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label>Teléfono Fijo</label>
                                    <input type="text" name="responsable_telefono"
                                           class="form-control" placeholder="">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label>Teléfono Celular</label>
                                    <input type="text" name="responsable_celular"
                                           class="form-control" placeholder="">
                                </div>
                            </div>
                        </div>
                    </fieldset>
                </div>
                <div id="ambientes_esconder">
                    <fieldset class="content-group" id="ambientesdata">
                        <legend class="text-bold">Ambientes</legend>
                        <div class="row">
                            <div class="col-md-8 col-md-offset-2">
                                <table class="table table-responsive table-bordered">
                                    <thead>
                                    <tr class="bg-blue">
                                        <th>Tipo de Ambiente</th>
                                        <th>Total</th>
                                        <th>Disponible</th>
                                        <th>A usar</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr>
                                        <td>Aula</td>
                                        <td><input type="text" name="cantidad_total_aulas"
                                                   id="cantidad_total_aulas"
                                                   class="form-control" value="">
                                        </td>
                                        <td><input type="text" name="cantidad_disponible_aulas"
                                                   id="cantidad_disponible_aulas"
                                                   class="form-control" value="">
                                        </td>
                                        <td><input type="text" name="cantidad_usar_aulas"
                                                   id="cantidad_usar_aulas"
                                                   class="form-control" value="">
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Auditorio</td>
                                        <td><input type="text" name="cantidad_total_auditorios"
                                                   id="cantidad_total_auditorios"
                                                   class="form-control" value="">
                                        </td>
                                        <td><input type="text" name="cantidad_disponible_auditorios"
                                                   id="cantidad_disponible_auditorios"
                                                   class="form-control" value="">
                                        </td>
                                        <td><input type="text" name="cantidad_usar_auditorios"
                                                   id="cantidad_usar_auditorios"
                                                   class="form-control" value="">
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Sala de Reuniones</td>
                                        <td><input type="text" name="cantidad_total_sala"
                                                   id="cantidad_total_sala"
                                                   class="form-control" value="">
                                        </td>
                                        <td><input type="text" name="cantidad_disponible_sala"
                                                   id="cantidad_disponible_sala"
                                                   class="form-control" value="">
                                        </td>
                                        <td><input type="text" name="cantidad_usar_sala"
                                                   id="cantidad_usar_sala"
                                                   class="form-control" value="">
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Oficina Administrativa</td>
                                        <td><input type="text" name="cantidad_total_oficina"
                                                   id="cantidad_total_oficina"
                                                   class="form-control" value="">
                                        </td>
                                        <td><input type="text" name="cantidad_disponible_oficina"
                                                   id="cantidad_disponible_oficina"
                                                   class="form-control" value="">
                                        </td>
                                        <td><input type="text" name="cantidad_usar_oficina"
                                                   id="cantidad_usar_oficina"
                                                   class="form-control" value="">
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Sala de Cómputo</td>
                                        <td><input type="text" name="cantidad_total_computo"
                                                   id="cantidad_total_computo"
                                                   class="form-control" value="">
                                        </td>
                                        <td><input type="text" name="cantidad_disponible_computo"
                                                   id="cantidad_disponible_computo"
                                                   class="form-control" value="">
                                        </td>
                                        <td><input type="text" name="cantidad_usar_computo"
                                                   id="cantidad_usar_computo"
                                                   class="form-control" value="">
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Otro (Especifique): <input type="text" name="especifique_otros"
                                                                       id="especifique_otros"
                                                                       class="form-control" value=""></td>
                                        <td><input type="text" name="cantidad_total_otros"
                                                   id="cantidad_total_otros"
                                                   class="form-control" value="">
                                        </td>
                                        <td><input type="text" name="cantidad_disponible_otros"
                                                   id="cantidad_disponible_otros"
                                                   class="form-control" value="">
                                        </td>
                                        <td><input type="text" name="cantidad_usar_otros"
                                                   id="cantidad_usar_otros"
                                                   class="form-control" value="">
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </fieldset>
                    <fieldset class="content-group">
                        <legend>REGISTRO DE AULA/S</legend>
                        <div class="row">
                            <table id="tabla_aulas" class="table table-bordered table-responsive">
                                <thead>
                                <tr>
                                    <th>N° Ord.</th>
                                    <th>Tipo de Ambiente</th>
                                    <th>N° Ambiente</th>
                                    <th>Capacidad</th>
                                    <th>Piso</th>
                                    <th>Guardar</th>
                                </tr>
                                </thead>
                                <tbody>

                                </tbody>
                                <tfoot>
                                <tr style="background-color:#A5C25C">
                                    <td colspan="3">TOTAL</td>
                                    <td>
                                        <span id="capacidad_total"></span>
                                    </td>
                                    <td></td>
                                </tr>
                                </tfoot>
                            </table>
                        </div>
                    </fieldset>
                </div>

                <div class="row">
                    <div class="text-left">
                        <button type="reset" class="btn btn-primary" id="reset">NUEVO LOCAL <i
                                class="icon-reload-alt position-right"></i></button>
                        <button type="button" id="registrar" class="btn btn-primary">Guardar <i
                                class="icon-arrow-right14 position-right"></i></button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <!-- /simple panel -->
    <!-- Footer -->
    <div class="footer text-muted">
    </div>
    <div id="modal_localesbyubigeo" class="modal fade">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-primary">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h6 class="modal-title">LOCALES POR UBIGEO</h6>
                </div>

                <div class="modal-body">
                    <table class="table datatable-basic table-bordered" id="table_localesubigeo">
                        <thead>
                        <tr class="bg-blue">
                            <th>Nombre Local</th>
                            <th>Nombre de Via</th>
                            <th>Referencia</th>
                            <th>Zona</th>
                            <th>Acción</th>
                        </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div id="modal_localesmarco" class="modal fade">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-primary">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h6 class="modal-title">LOCALES POR MARCO</h6>
                </div>

                <div class="modal-body">
                    <table class="table datatable-basic table-bordered" id="table_localesmarco">
                        <thead>
                        <tr class="bg-blue">
                            <th>Nombre Local</th>
                            <th>Zona</th>
                            <th>Acción</th>
                        </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div id="modal_registroaula" class="modal fade">
        <input type="hidden" id="id_localambiente" name="id_localambiente">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-primary">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h6 class="modal-title">Registro de Aula</h6>
                </div>

                <div class="modal-body">
                    <div id="msg_error" class="alert alert-warning" style="display: none;">No se puede agregar mas
                        ambientes de los que se puede usar
                    </div>
                    <form id="form_aula" class="form-validate-aula" action="#">
                        <fieldset class="content-group">
                            <legend>Ambiente</legend>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label>Ambiente</label>
                                        <select name="id_ambiente" class="select2 form-control"
                                                id="id_ambiente"></select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label>Capacidad Ambiente</label>
                                        <input type="text" name="capacidad" class="form-control" required
                                               placeholder="">
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label>Piso</label>
                                        <input type="text" name="n_piso" class="form-control" required placeholder="">
                                    </div>
                                </div>
                            </div>
                        </fieldset>
                        <div class="text-left">
                            <button type="button" class="btn btn-primary" data-dismiss="modal">CERRAR</button>
                            <button type="button" id="registrar_aula_submit" class="btn btn-primary">GUARDAR</button>
                            <button type="button" id="limpiar_form_aula" class="btn btn-primary">NUEVO LOCAL</button>
                        </div>
                    </form>
                </div>

                <div class="modal-footer">

                </div>
            </div>
        </div>
    </div>

    <!-- /.modal -->
{% endblock %}

{% block js %}
    <script type="text/javascript" src="{% static "assets/js/plugins/tables/datatables/datatables.min.js" %}"></script>
    <script type="text/javascript" src="{% static "assets/js/plugins/forms/validation/validate.min.js" %}"></script>
    <script type="text/javascript" src="{% static "assets/js/plugins/notifications/sweet_alert.min.js" %}"></script>
    <script type="text/javascript" src="{% static "assets/js/plugins/notifications/pnotify.min.js" %}"></script>
    <script type="text/javascript" src="{% static "assets/js/plugins/forms/selects/select2.min.js" %}"></script>
    <script type="text/javascript" src="{% static "assets/js/plugins/forms/styling/uniform.min.js" %}"></script>
    <script type="text/javascript" src="{% static "assets/js/plugins/ui/moment/moment.min.js" %}"></script>
    <script type="text/javascript" src="{% static "assets/js/plugins/ui/moment/moment_locales.min.js" %}"></script>
    <script type="text/javascript" src="{% static "assets/js/plugins/pickers/daterangepicker.js" %}"></script>
    <script type="text/javascript" src="{% static "assets/js/core/app.js" %}"></script>
    <script type="text/javascript" src="{% static "assets/js/plugins/ui/ripple.min.js" %}"></script>
    <script type="text/javascript" src="{% static "assets/js/capacitacion/index.js" %}"></script>
    <script type="text/javascript" src="{% static "assets/js/capacitacion/aula.js" %}"></script>
    <script>
        $(function () {
            jQuery.extend(jQuery.validator.messages, {
                required: "Este campo es obligatorio.",
                remote: "Por favor, rellena este campo.",
                email: "Por favor, escribe una dirección de correo válida",
                url: "Por favor, escribe una URL válida.",
                date: "Por favor, escribe una fecha válida.",
                dateISO: "Por favor, escribe una fecha (ISO) válida.",
                number: "Por favor, escribe un número entero válido.",
                digits: "Por favor, escribe sólo dígitos.",
                creditcard: "Por favor, escribe un número de tarjeta válido.",
                equalTo: "Por favor, escribe el mismo valor de nuevo.",
                accept: "Por favor, escribe un valor con una extensión aceptada.",
                maxlength: jQuery.validator.format("Por favor, no escribas más de {0} caracteres."),
                minlength: jQuery.validator.format("Por favor, no escribas menos de {0} caracteres."),
                rangelength: jQuery.validator.format("Por favor, escribe un valor entre {0} y {1} caracteres."),
                range: jQuery.validator.format("Por favor, escribe un valor entre {0} y {1}."),
                max: jQuery.validator.format("Por favor, escribe un valor menor o igual a {0}."),
                min: jQuery.validator.format("Por favor, escribe un valor mayor o igual a {0}.")
            });
            $('.select').select2();
            $(".styled, .multiselect-container input").uniform({
                radioClass: 'choice'
            });

            $('input[name="fecha_inicio"]').daterangepicker({
                //"minDate": fecha_hoy,
                "minDate": "19/01/2017",
                "maxDate": "31/10/2017",
                singleDatePicker: true,
                locale: {
                    format: 'DD/MM/YYYY'
                }
            }, function (chosen_date) {
                $('input[name="fecha_inicio"]').val(chosen_date.format('DD/MM/YYYY'));
            });

            $('input[name="fecha_fin"]').daterangepicker({
                //"minDate": fecha_hoy,
                "minDate": "19/01/2017",
                "maxDate": "31/10/2017",
                singleDatePicker: true,
                locale: {
                    format: 'DD/MM/YYYY'
                }
            }, function (chosen_date) {
                $('input[name="fecha_fin"]').val(chosen_date.format('DD/MM/YYYY'));
            });
            getDepartamentos();
            getCursos(1);
            getMetaPea();
        });
        $('#etapa').val(1);
        function resetForm(idform) {
            "use strict";
            $('#' + idform + ' :input').map(function () {
                $(this).val('')
            });
            $('#' + idform + ' :input[type="checkbox"]').map(function () {
                $(this).prop('checked', false);
                $.uniform.update();
            });
        }

        $('#departamentos').change(function () {
            $('#provincias').find('option').remove();
            getProvincias();
        });

        $('#provincias').change(function () {
            $("#distritos").find('option').remove();
            getDistritos();
        });

        $('#distritos').change(function () {
            $("#zona").find('option').remove();
            $('#zona_ubicacion_local').find('option').remove();
            getZonas();
        });

        $('#buscarlocal').click(function () {
            getLocalesbyUbigeo();
        });

        $('#buscarlocalmarco').click(function () {
            getLocalesbyMarco();
        });

        $('#cursos').change(() => {
            "use strict";
            getMetaPea();
        });
        jQuery.validator.addMethod("validateFechaInicio", function (value, element) {
            let fechafin = $('input[name="fecha_fin"]').val();
            var part_ff = fechafin.split("/");
            var fin = new Date(`${part_ff[1]}/${part_ff[0]}/${part_ff[2]}`);
            var part_fi = value.split("/");
            var inicio = new Date(`${part_fi[1]}/${part_fi[0]}/${part_fi[2]}`);

            var f = Date.parse(fin);
            var i = Date.parse(inicio);
            return f >= i
        }, jQuery.validator.format("Fecha de Inicio tiene que ser menor que la Fecha Fin"));

        jQuery.validator.addMethod("esMenor", function (value, element) {
            var nameelement = $(element).attr('name');
            nameelement = nameelement.replace('usar', 'disponible');
            var val_ne = $('#' + nameelement).val();
            if (value == '') {
                return true
            } else {
                return parseInt(value) <= parseInt(val_ne)
            }

        }, jQuery.validator.format("Debe ser menor a Disponible"));

        jQuery.validator.addMethod("esMenor2", function (value, element) {
            var nameelement = $(element).attr('name');
            nameelement = nameelement.replace('disponible', 'total');
            var val_ne = $('#' + nameelement).val();
            if (value == '') {
                return true
            } else {
                return parseInt(value) <= parseInt(val_ne)
            }

        }, jQuery.validator.format("Debe ser menor a Total"));


        jQuery.validator.addMethod("validar9", function (value, element) {
            var count = 0;
            if (value.length > 0) {
                for (let k in value) {
                    if (value[0] == value[parseInt(k) + 1]) {
                        count++;
                    }
                }
            }
            console.log(count);
            return (count > 5) ? false : true;
        }, jQuery.validator.format("Número no permitido"));

        jQuery.validator.addMethod("validateFechaFin", function (value, element) {
            let fechafin = $('input[name="fecha_inicio"]').val();
            var part_ff = fechafin.split("/");
            var fin = new Date(`${part_ff[1]}/${part_ff[0]}/${part_ff[2]}`);
            var part_fi = value.split("/");
            var inicio = new Date(`${part_fi[1]}/${part_fi[0]}/${part_fi[2]}`);

            var f = Date.parse(fin);
            var i = Date.parse(inicio);

            console.log(f, i);
            console.log(f < i);
            return f <= i
        }, jQuery.validator.format("Fecha de Fin tiene que ser mayor que la Fecha Inicio"));

        var validator = $(".form-validate-jquery").validate({
            ignore: 'input[type=hidden], .select2-search__field', // ignore hidden fields
            errorClass: 'validation-error-label',
            successClass: 'validation-valid-label',
            highlight: function (element, errorClass) {
                $(element).removeClass(errorClass);
            },
            unhighlight: function (element, errorClass) {
                $(element).removeClass(errorClass);
            },

            // Different components require proper error label placement
            errorPlacement: function (error, element) {

                // Styled checkboxes, radios, bootstrap switch
                if (element.parents('div').hasClass("checker") || element.parents('div').hasClass("choice") || element.parent().hasClass('bootstrap-switch-container')) {
                    if (element.parents('label').hasClass('checkbox-inline') || element.parents('label').hasClass('radio-inline')) {
                        error.appendTo(element.parent().parent().parent().parent());
                    } else {
                        error.appendTo(element.parent().parent().parent().parent().parent());
                    }
                }

                // Unstyled checkboxes, radios
                else if (element.parents('div').hasClass('checkbox') || element.parents('div').hasClass('radio')) {
                    error.appendTo(element.parent().parent().parent());
                }

                // Input with icons and Select2
                else if (element.parents('div').hasClass('has-feedback') || element.hasClass('select2-hidden-accessible')) {
                    error.appendTo(element.parent());
                }

                // Inline checkboxes, radios
                else if (element.parents('label').hasClass('checkbox-inline') || element.parents('label').hasClass('radio-inline')) {
                    error.appendTo(element.parent().parent());
                }

                // Input group, styled file input
                else if (element.parent().hasClass('uploader') || element.parents().hasClass('input-group')) {
                    error.appendTo(element.parent().parent());
                } else {
                    error.insertAfter(element);
                }
            },
            validClass: "validation-valid-label",
            rules: {
                nombre_local: {
                    maxlength: 100
                },
                nombre_via: {
                    maxlength: 200
                },
                referencia: {
                    maxlength: 100
                },
                n_direccion: {
                    maxlength: 4
                },
                km_direccion: {
                    maxlength: 3
                },
                mz_direccion: {
                    maxlength: 4
                },
                lote_direccion: {
                    maxlength: 4
                },
                piso_direccion: {
                    maxlength: 1
                },
                telefono_local_fijo: {
                    maxlength: 9
                },
                telefono_local_celular: {
                    maxlength: 10,
                    validar9: true
                },
                fecha_fin: {
                    validateFechaFin: true,
                },
                responsable_nombre: {
                    minlength: 9,
                },
                responsable_email: {
                    minlength: 1,
                },
                responsable_telefono: {
                    maxlength: 9
                },
                responsable_celular: {
                    maxlength: 10,
                    validar9: true
                },
                cantidad_disponible_aulas: {
                    esMenor2: true
                },
                cantidad_disponible_auditorios: {
                    esMenor2: true
                },
                cantidad_disponible_sala: {
                    esMenor2: true
                },
                cantidad_disponible_oficina: {
                    esMenor2: true
                },
                cantidad_disponible_otros: {
                    esMenor2: true
                },
                cantidad_usar_aulas: {
                    esMenor: true
                },
                cantidad_usar_auditorios: {
                    esMenor: true
                },
                cantidad_usar_sala: {
                    esMenor: true
                },
                cantidad_usar_oficina: {
                    esMenor: true
                },
                cantidad_usar_otros: {
                    esMenor: true
                },
            },
            messages: {
                custom: {
                    required: "El campo es requerido",
                },
                agree: "Please accept our policy"
            }
        });

        $('#reset').on('click', function () {
            location.reload();
        });

        $('#funcionario_nombre').change(e => {
            "use strict";
            let id_per = $('#funcionario_nombre').val();
            id_per = id_per.trim();
            $.getJSON(`${BASEURL}/get_funcionarioinei/${id_per}/`, response => {
                $('input[name="funcionario_email"]').val(response[0].correo);
                $('input[name="funcionario_cargo"]').val(response[0].cargo);
                $('input[name="funcionario_celular"]').val(response[0].celular);
            });
        });
        moment.locale('es');
    </script>
    <script>
        $('#modulo_registro').addClass('active');

    </script>

{% endblock %}